# æ™ºæ¸”äº‘é¡¹ç›®å‰ç«¯åº“

[toc]

## â€œOur Codeâ€ç†å¿µï¼š
1. ä»£ç æ˜¯æˆ‘ä»¬çš„ï¼Œéœ€è¦éµå¾ªå…±åŒçš„è§„èŒƒï¼›
2. ä»£ç æ˜¯æˆ‘å†™çš„ï¼Œå´æ˜¯è¦ç»™ä½ æ”¹çš„ï¼Œæœ€ç»ˆæ˜¯ä»–çš„â€”â€”éœ€è¦æ¢ä½æ€è€ƒä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œé¿å…å½¼æ­¤æŒ–å‘ã€‚

## å¼€å‘åŸºæœ¬åŸåˆ™
1. éš”ç¦»ï¼Œæ¯ä¸ªç‹¬ç«‹çš„åŠŸèƒ½æŠ½è±¡ä¸ºç‹¬ç«‹çš„å­APPï¼ˆæ¨¡å—ï¼‰ï¼›
2. ç»Ÿä¸€ï¼Œä¿æŒæ¨¡å¼ã€åŠŸèƒ½å®ç°å’Œæ’ç‰ˆæ ¼å¼çš„ä¸€è‡´æ€§ï¼›
3. ç®€æ´ï¼Œä¿æŒæ¨¡æ¿å’Œæ ·å¼çš„ç®€ç»ƒã€å‡å°‘ç¬¬ä¸‰æ–¹åº“çš„ä¾èµ–ï¼Œé¿å…å¼•å…¥å¤æ‚ï¼›
4. æ¸…æ™°ï¼Œä¿æŒæ¸…æ™°çš„æ ‘å½¢ç»“æ„ï¼Œä¿æŒ**å•å‘æ•°æ®æµ**ã€‚

---
## ç»„ä»¶è®¾è®¡

### åŸåˆ™
1. å°†ç»„ä»¶è®¾è®¡ä¸ºâ€œé»‘ç›’å­â€ï¼Œå³çº¯ç»„ä»¶ï¼Œå¤–éƒ¨å¯¹å…¶ä½¿ç”¨ä¾èµ–äºç¡®å®šå€¼ã€‚

### è§„èŒƒ
1. å§‹ç»ˆä½¿ç”¨ kebab-case çš„äº‹ä»¶åï¼ˆ[åŸå› ](https://cn.vuejs.org/v2/guide/components-custom-events.html#äº‹ä»¶å)ï¼‰
2. è¶…è¿‡100è¡Œçš„Vueæ–‡ä»¶åº”æ‹†åˆ†ä¸ºç‹¬ç«‹çš„jsï¼Œcssï¼Œhtmlæ–‡ä»¶ï¼›
3. äº‹ä»¶ç±»å‹ç»Ÿä¸€æ·»åŠ `on-`å‰ç¼€ï¼Œå³`this.$emit('on-success', value)`ï¼›
4. äº‹ä»¶å¤„ç†å™¨ç»Ÿä¸€æ·»åŠ `handle`å‰ç¼€ï¼Œå³`@on-success="handleUpdateNameSuccess"`ï¼›

### `v-model` ä½¿ç”¨åŸåˆ™
1. å°½é‡ä¸è¦ä½¿ç”¨ï¼Œ`v-model` çš„é»‘é­”æ³•æ˜¯ä»ç»„ä»¶çš„é»‘ç›’å­å†…éƒ¨å¯¹ä¸€ä¸ªå€¼çš„â€œçªå˜â€ï¼Œå­˜åœ¨ä¸ç¡®å®šæ€§å’Œä¸å¯æ§æ€§ï¼›
2. ä¸ç¡®å®šæ€§æ˜¯æ— æ³•ç¡®å®šå€¼çš„æ”¹å˜æ˜¯ç”±å¤–éƒ¨ä»£ç æ“æ§ï¼Œè¿˜æ˜¯ç»„ä»¶å†…éƒ¨è§¦æ§ï¼›
3. ä¸å¯æ§æ€§è·Ÿä¸ç¡®å®šæ€§ç±»ä¼¼ï¼Œç»„ä»¶çš„é»‘ç›’å­å†…éƒ¨å¯ä»¥ä¸å—å¤–éƒ¨æ§åˆ¶çš„æ”¹å˜å€¼ï¼Œè€Œè¿™ä¸ªå€¼æœ‰å¯èƒ½ä¼šå¯¹å¤–éƒ¨çš„ç¨‹åºäº§ç”Ÿå‰¯ä½œç”¨ã€‚

### `v-model` çš„åˆé€‚ä½¿ç”¨åœºæ™¯
1. è¡¨å•å‹ç»„ä»¶ï¼ˆæ¯”å¦‚`i-input`ï¼‰çš„å¤„ç†ï¼Œåœ¨è¯¥åœºæ™¯ä¸‹ï¼Œè¡¨å•ç»„ä»¶çš„`value`æ˜¯åœ¨å¤–éƒ¨æ˜ç¡®æœŸæœ›è·å–çš„ï¼Œè€Œä¸”æ˜ç¡®ç”±ç»„ä»¶å†…éƒ¨è¾“å…¥æ§åˆ¶çš„ï¼Œæ˜¯å¯¹`onChange`çš„ç®€å†™å½¢å¼ï¼ˆæœ¬è´¨ä¸Šï¼šæœŸå¾…çš„æ•°æ®æµå‘æ˜¯æ˜ç¡®çš„ï¼Œä»å†…éƒ¨æµå‘å¤–éƒ¨ï¼‰ã€‚
2. ç»„ä»¶å¯å®Œå…¨æ§åˆ¶çš„åœºæ™¯ã€‚

    > ä¸€ä¸ªç»„ä»¶ä¸Šçš„ v-model é»˜è®¤ä¼šåˆ©ç”¨åä¸º value çš„ prop å’Œåä¸º input çš„äº‹ä»¶

### `.sync`å’Œ`v-model`çš„åŒºåˆ«
1. æš‚æ—¶æ²¡æœ‰æƒ³åˆ°ä¸¤è€…ä¸¥æ ¼çš„å·®å¼‚ğŸ¤ªï¼›
2. è¡¨é¢ä¸Šçœ‹åªæ˜¯`$emit 'change'`å’Œ`$emit 'update'`çš„åŒºåˆ«ï¼ˆ[.sync](https://cn.vuejs.org/v2/guide/components-custom-events.html#sync-ä¿®é¥°ç¬¦)ï¼‰ã€‚

#### å‚è€ƒ
1. [é€šè¿‡äº‹ä»¶å‘çˆ¶çº§ç»„ä»¶å‘é€æ¶ˆæ¯](https://cn.vuejs.org/v2/guide/components.html#é€šè¿‡äº‹ä»¶å‘çˆ¶çº§ç»„ä»¶å‘é€æ¶ˆæ¯)
2. [è‡ªå®šä¹‰äº‹ä»¶](https://cn.vuejs.org/v2/guide/components-custom-events.html)


---
## è·¯ç”±è®¾è®¡

### åŸåˆ™
1. å°†è·¯ç”±ç®€åŒ–æŠ½è±¡ä¸º[RESTful](https://zh.wikipedia.org/wiki/è¡¨ç°å±‚çŠ¶æ€è½¬æ¢)çš„URLï¼Œå³æ¯ä¸€ä¸ªURLå¯ç‹¬ç«‹å¯åŠ¨å¯¹åº”åº”ç”¨ç¨‹åºçš„çŠ¶æ€å’ŒåŠŸèƒ½ï¼›
2. æ— çŠ¶æ€ï¼Œåˆ·æ–°æµè§ˆå™¨åå¯å®Œæ•´è¿˜åŸé¡µé¢çš„çŠ¶æ€å’ŒåŠŸèƒ½ï¼Œä¸ä¾èµ–äºä¹‹å‰çš„é¡µé¢æ“ä½œã€‚

### è§„èŒƒ
1. å‡é€šè¿‡ä¸€ä¸ªåç§°æ¥æ ‡è¯†ä¸€ä¸ªâ€˜å¶å­è·¯ç”±â€™ï¼Œåç§°ï¼ˆnameï¼‰ä¸¥æ ¼ä½¿ç”¨camelCaseæ ¼å¼ï¼Œéµå¾ªmodule.nested.routeNameçš„å‘½åè§„èŒƒï¼›
2. è·¯å¾„ï¼ˆpathï¼‰å…¨å°å†™ï¼Œå’Œæ–‡ä»¶çš„å‘½åæ ¼å¼ä¿æŒä¸€è‡´ï¼Œä½¿ç”¨kebab-caseæ ¼å¼ï¼›
3. è·¯ç”±ç»Ÿä¸€ä½¿ç”¨æè¿°åœ°å€çš„å¯¹è±¡æ‰§è¡Œè·³è½¬ï¼Œåœ¨`:to`å’Œç¼–ç¨‹ä¸¤ç§å½¢å¼ä¸­ä¿æŒä¸€è‡´ã€‚


---
## Store è®¾è®¡

### åŸåˆ™
1. ä¿æŒå•å‘æ•°æ®æµï¼›
2. ä½¿ç”¨namespace éš”ç¦»å„ä¸ªåŠŸèƒ½çŠ¶æ€ï¼›
3. ä»æ¨¡å‹å±æ€§è¡ç”Ÿå‡ºçš„è§†å›¾æ¨¡å‹å±æ€§ï¼Œä½¿ç”¨computedï¼ˆgetterï¼‰è¡¨è¾¾ã€‚

### è§„èŒƒ
1. strictè®¾ç½®ä¸ºtrueï¼›
2. namespaceè®¾ç½®ä¸ºtrueï¼›
3. å½“ä½¿ç”¨ mapState, mapGetters, mapActions å’Œ mapMutations è¿™äº›å‡½æ•°æ¥ç»‘å®šå¸¦å‘½åç©ºé—´çš„æ¨¡å—æ—¶ï¼Œå°†æ¨¡å—çš„ç©ºé—´åç§°å­—ç¬¦ä¸²ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ä¸Šè¿°å‡½æ•°ï¼›


---
## Request

### åŸåˆ™
ä½¿ç”¨ä»£ç†ç£¨å¹³å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒçš„å·®å¼‚ï¼Œç›´æ¥ä½¿ç”¨æœ€ç»ˆçš„Pathå‘èµ·è¯·æ±‚ï¼›

---
## Filter

### åŸåˆ™
å®šä¹‰ä¸€å¥—æ ‡å‡†æ¥è¿‡æ»¤ä¸€ç»„å¯¹è±¡ï¼›

### è§„èŒƒ
1. è„±ç¦»ä¸šåŠ¡é€»è¾‘è€ŒæŠ½è±¡å‡ºæ¥çš„å…¬ç”¨çš„è¿‡æ»¤å™¨ï¼ˆä¾‹å¦‚æ—¶é—´çš„æ ¼å¼åŒ–è¿‡æ»¤å™¨ï¼‰ï¼Œæ”¾åœ¨commonçš„filteræ–‡ä»¶å¤¹ä¸­å¹¶ä¸”å…¨å±€å®šä¹‰è¿‡æ»¤å™¨ï¼›
2. åœ¨ä¸šåŠ¡æ¨¡å—ä¸­ï¼Œè¿‡æ»¤å™¨å®šä¹‰åœ¨æ¨¡å—çš„filteræ–‡ä»¶ä¸­ã€‚éœ€è¦ä½¿ç”¨è¿‡æ»¤å™¨çš„ç»„ä»¶ï¼Œå¼•ç”¨filteræ–‡ä»¶å¹¶åœ¨ç»„ä»¶ä¸­å®šä¹‰æœ¬åœ°çš„è¿‡æ»¤å™¨ï¼›


---
## æ–‡ä»¶åŠä»£ç å‘½åè§„èŒƒ

### æ–‡ä»¶å¤¹å‘½åè§„èŒƒ

1. æ–‡ä»¶å¤¹ä¸€å¾‹é‡‡ç”¨å…¨å°å†™ä¸­æ åˆ†éš”çš„å½¢å¼ï¼Œä¾‹å¦‚ `ecs-seahare` è¿›è¡Œå‘½åã€‚

### æ–‡ä»¶å‘½åè§„èŒƒ

1. æ–‡ä»¶ä¸€å¾‹é‡‡ç”¨å…¨å°å†™ä¸­æ åˆ†éš”çš„å½¢å¼ï¼Œä¾‹å¦‚ `toggle-password.vue` è¿›è¡Œå‘½å

### ä»£ç å‘½åè§„èŒƒ

1. è¾“å‡ºå’Œæ³¨å†Œç»„ä»¶ä¸€å¾‹é‡‡ç”¨å¤§å†™é©¼å³°å½¢å¼ï¼Œä¾‹å¦‚`LoginTemplate`ï¼›
2. ä½¿ç”¨ç»„ä»¶æ—¶ä¸€å¾‹é‡‡ç”¨å…¨å°å†™ä¸­æ åˆ†éš”çš„å½¢å¼ï¼Œä¾‹å¦‚`<login-template></login-template>`ï¼›
3. åœ¨ä¹¦å†™ html æ—¶ï¼Œä¸ºåŒºåˆ†`iview`è‡ªå®šä¹‰çš„æ ‡ç­¾å’Œ`html`åŸç”Ÿæ ‡ç­¾ï¼Œéœ€è¦å°†`iview`æ ‡ç­¾å†™æˆå¸¦æœ‰`i-`å‰ç¼€çš„å½¢å¼ã€‚å¦‚ï¼š`<i-menu-item></i-menu-item>`ï¼›
4. `import`vueæ–‡ä»¶ç»„ä»¶æ—¶å¿…é¡»æ·»åŠ `vue`åç¼€ï¼ˆåŸå› ï¼šwebpackæ— æ³•åŒºåˆ†åŒåçš„.jså’Œ.vueæ–‡ä»¶ï¼Œä¸¤è€…ä¼šäº§ç”Ÿä¸ç¡®å®šéšæœºå¼•ç”¨ï¼Œæœ‰å¯èƒ½é€ æˆæ–‡ä»¶å…¥å£é”™è¯¯ï¼‰ï¼›
5. `import`é¢‘é“ï¼ˆå­Appï¼‰å†…æ–‡ä»¶ç”¨ç›¸å¯¹è·¯å¾„ï¼Œé¢‘é“å¤–æ–‡ä»¶ç”¨ç»å¯¹è·¯å¾„ï¼ˆ`'@/common/utils/request'`ï¼‰ï¼›

#### é—ç•™å¾…è€ƒè™‘é—®é¢˜

1. é¡¹ç›®ä¸­jsã€cssä»¥åŠVueæ–‡ä»¶æ˜¯å¦éœ€è¦è¿›è¡Œæ–‡ä»¶å¤¹å½’å±æ‹†åˆ†

### ç›®å½•ç»“æ„ç¤ºæ„å›¾
![ç›®å½•ç»“æ„ç¤ºæ„å›¾](./ç›®å½•ç»“æ„ç¤ºæ„å›¾.png)

---
## APIæ¥å£

1. æ‰€æœ‰çš„APIæ¥å£å­—æ®µä¿¡æ¯ä¿æŒä¸€è‡´ï¼›
2. æ—¶é—´ç»Ÿä¸€ä»¥æ¯«ç§’çº§åˆ«çš„å½¢å¼è¿›è¡Œä¼ é€’ï¼Œå‰ç«¯è¿›è¡Œå¯¹æ—¶é—´æ•°æ®çš„å¤„ç†ï¼›
3. APIæ¥å£ä¿¡æ¯ä¸­ä¸ç”¨çš„å­—æ®µä¸åº”è¯¥ä¼ é€’ï¼›
4. APIæ¥å£å­—æ®µå°½é‡è¿”å›æ•°æ®åº“åŸå§‹æ•°æ®ï¼Œä¿æŒæ•°æ®çš„å¯å¤ç”¨æ€§ä»¥åŠåŸå§‹æ€§ï¼›


## å¸¸ç”¨è‡ªå®šä¹‰è¿‡æ»¤å™¨

### 1. `dtf`

#### ä½œç”¨
æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²ã€‚

#### ä½¿ç”¨æ–¹æ³•
`dtf`æˆ–`dtf('yyyy-MM-dd')`ï¼Œ[APIå‚è€ƒ](https://moment.github.io/luxon/docs/manual/formatting.html#formatting-with-tokens--strings-for-cthulhu-)ã€‚


---
## å¸¸ç”¨è‡ªå®šä¹‰æŒ‡ä»¤

### 1. `v-timely-validate`

#### ä½œç”¨
å°†è¡¨å•éªŒè¯è§„åˆ™`rules`ä¸­éªŒè¯çš„è§¦å‘æ—¶æœºä»`blur`ä¿®æ”¹ä¸º`change`ï¼Œä»¥åŠæ—¶æ¶ˆé™¤é”™è¯¯ã€‚

#### è¡¨å•æ ¡éªŒåŸåˆ™
1. å°½é‡ä¸å¼ºè¡Œé˜»æ­¢ç”¨æˆ·ï¼ˆæ¯”å¦‚`text`è¡¨å•å…ƒç´ ä¸­ä¸æˆªæ–­ç”¨æˆ·çš„è¶…é•¿åº¦è¾“å…¥ï¼Œ`number`è¡¨å•å…ƒç´ ä¸­ä¸é˜»æ­¢ç”¨æˆ·è¾“å…¥å­—ç¬¦ç­‰ï¼ŒåŠæ—¶æé†’å°±å¥½ï¼‰ï¼›
2. åŠæ—¶æé†’ç”¨æˆ·å‡ºé”™ï¼›
3. ä¸æ‰“æ‰°ç”¨æˆ·æ­£å¸¸è¾“å…¥ï¼ˆæ¯”å¦‚ç¬¬ä¸€æ¬¡è¾“å…¥ç”¨`blur`æ—¶æœºæ ¡éªŒï¼‰ï¼›
4. å°½æ—©æ¶ˆé™¤é”™è¯¯æé†’ï¼ˆæ¯”å¦‚æœ‰äº†å‡ºé”™æé†’åç”¨`change`æ—¶æœºæ ¡éªŒï¼‰ï¼›

#### ä½¿ç”¨æ–¹æ³•
1. åœ¨`i-form`è¡¨å•ç»„ä»¶ä¸­æ·»åŠ `v-timely-validate`æŒ‡ä»¤ï¼›
2. åœ¨`i-input`ç­‰è¡¨å•å…ƒç´ ç»„ä»¶ä¸­æ·»åŠ è·Ÿ`rules`å¯¹åº”çš„`name`å±æ€§ï¼›
3. åœ¨`i-form`çš„`rules`ä¸­ä½¿ç”¨`blur`è§¦å‘ã€‚

---
## QA

### 1. `beforeRouteUpdate`è§¦å‘é—®é¢˜

#### åŸå› 
ä¸åŒè·¯ç”±åŒå¯¹ä¸€ä¸ªç»„ä»¶å­˜åœ¨å¤ç”¨ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºä»è·¯ç”±1è¿›å…¥è·¯ç”±2æ—¶ï¼Œä¸ä¼šè§¦å‘`beforeRouteUpdate`æ–¹æ³•ã€‚

#### è§£å†³
1. è®©ä¸¤è€…è·¯ç”±å…¼å®¹ï¼Œä½¿å…¶åœ¨åŒä¸€ä¸ªè·¯ç”±ä¸­åŒ¹é…ï¼Œé¿å…ä¸Šé¢çš„åœºæ™¯å‡ºç°ï¼›

#### Todo
æœ‰å¯èƒ½åœ¨åˆ«åè·¯ç”±ä¸­ä¹Ÿä¼šå­˜åœ¨ä¸Šé¢çš„é—®é¢˜ï¼Œæœªæµ‹è¯•ã€‚

#### å…¶ä»–
1. `beforeRouteUpdate`åªèƒ½åœ¨ç»‘å®šè·¯ç”±çš„ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œå…¶ä»–ç»„ä»¶ä¸­ä¸ä¼šå“åº”ï¼›

#### ä½¿ç”¨å‘ç”Ÿåœºæ™¯
1. åœ¨åˆ—è¡¨é¡µæœ‰åˆ†é¡µä»¥åŠåœ¨å½“å‰é¡µéœ€è¦è¿›è¡ŒæŸ¥è¯¢æœç´¢æ¡ä»¶æ—¶ï¼Œurlè·¯ç”±é…ç½®æ—¶å€™éœ€è¦æ³¨æ„

#### ç¤ºä¾‹ä»£ç 
```javascript
// æ›´æ”¹å‰
{
    // è·¯ç”±1
    path: '',
    component: () => import(/* webpackChunkName: "ecs-seahare" */ './views/index.vue'),
},
{
    // è·¯ç”±2
    path: ':page(\\d+)/:keyword?',
    component: () => import(/* webpackChunkName: "ecs-seahare" */ './views/index.vue'),
},

// æ›´æ”¹å
{
    // æ³¨æ„è·¯ç”±ä¹‹é—´ä¼šç›¸äº’å†²çª
    path: ':page(\\d+)/:keyword?',
    component: () => import(/* webpackChunkName: "ecs-seahare" */ './views/index.vue'),
},
```
### 2. è¢«å¤ç”¨ç»„ä»¶çŠ¶æ€æ›´æ–°é—®é¢˜

#### è¡¨ç°
é¡¹ç›®ä¸­çš„å·¦ä¾§èœå•åœ¨éƒ¨åˆ†é¡µé¢è·³è½¬æ—¶ï¼Œæ²¡æœ‰ç›¸åº”æ”¹å˜å½“å‰é«˜äº®é¡¹ç›®ï¼Œä¾æ—§æ˜¯å‰ä¸€ä¸ªé¡µé¢çš„é«˜äº®çŠ¶æ€

#### åŸå› 
`router-view` å†…çš„é¡µé¢è·³è½¬ï¼Œä¼šå¤ç”¨ç›¸åŒç»„ä»¶ï¼Œå½“å‰èœå•é«˜äº®æ–¹æ³• `currentHighlight` åœ¨ç»„ä»¶å†… `created` å‘¨æœŸä¸­è°ƒç”¨ï¼Œå› ä¸ºç»„ä»¶å®ä¾‹å¤ç”¨ï¼Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸ä¼šå†è¢«è°ƒç”¨ï¼Œé«˜äº®æ–¹æ³•æ²¡æœ‰æ‰§è¡Œã€‚

#### åˆ†æå°è¯•
`currentHighlight` æ–¹æ³•åœ¨é€‚å½“æ—¶æœºè°ƒç”¨æ˜¯è§£å†³é—®é¢˜çš„å…³é”®ï¼Œå¦‚æœåœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå†…è°ƒç”¨æ–¹æ³•ä¼šå› ä¸ºç»„ä»¶çš„å¤ç”¨è€Œä¸è¢«æ‰§è¡Œï¼Œå› ä¸ºæ˜¯è·¯ç”±å‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤å°è¯•åœ¨ç»„ä»¶å†…ä½¿ç”¨å¯¼èˆªå®ˆå«æä¾›çš„`beforeRouteEnter` è°ƒç”¨ `currentHighlight` æ–¹æ³•
``` javascript
beforeRouteEnter(to, from, next) {
    next((vm) => {
        vm.currentHighlight();
    });
},
```
ä½†æ–¹æ³•ä¾ç„¶æ²¡æœ‰è¢«è°ƒç”¨æ‰§è¡Œï¼Œä¸ºäº†éªŒè¯ `beforeRouteEnter` å¯ä»¥ä½¿ç”¨çš„ç»„ä»¶åœºæ™¯ï¼Œè¿›è¡Œäº†ä¸‰ç§æƒ…å†µçš„æµ‹è¯•ï¼›

* åœ¨ `router.js` å†…å¼•ç”¨çš„ç»„ä»¶ï¼Œ**å¯ä»¥ä½¿ç”¨**
* åœ¨ `router.js` å†…å¼•ç”¨çš„ç»„ä»¶çš„å­ç»„ä»¶ï¼Œ**æ— æ³•ä½¿ç”¨ï¼**
* æ²¡æœ‰åœ¨ `router.js` å†…å¼•ç”¨çš„ç»„ä»¶ï¼Œ**æ— æ³•ä½¿ç”¨ï¼**

å› æ­¤ï¼Œåªæœ‰åœ¨ `router.js` é‡Œç›´æ¥å¼•ç”¨çš„ç»„ä»¶å®ä¾‹å†…å¯ä»¥ä½¿ç”¨ `beforeRouteEnter`ç­‰ç»„ä»¶é’©å­æ–¹æ³•ï¼Œå…¶ä»–ç»„ä»¶å†…éƒ½ä¸èƒ½ä½¿ç”¨ï¼Œèœå•ç»„ä»¶å±äºæ²¡æœ‰è¢« `router.js` å¼•ç”¨çš„ç»„ä»¶ï¼Œå› æ­¤åªèƒ½é‡‡ç”¨å…¶ä»–æ–¹å¼è°ƒç”¨ `currentHighlight` æ–¹æ³•ï¼›


#### è§£å†³
åœ¨è¢«å¤ç”¨ç»„ä»¶å†…ï¼Œä½¿ç”¨ `watch` è§‚å¯Ÿ `$route` çš„å˜åŒ–ï¼Œè§¦å‘ `currentHighlight` æ–¹æ³•ï¼Œå¯ä»¥è§£å†³
```javascript
watch: {
        $route() {
            this.currentHighlight();
        },
    },
```
å‚è€ƒï¼š[Vue Routerå®˜æ–¹è¯´æ˜](https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–)

### 3. ç¬¬ä¸‰æ–¹ä¾èµ–è¯­æ³•è½¬åŒ–é…ç½®

#### åŸå› 
IE11 ä¸èƒ½è¿è¡Œé¡¹ç›®ï¼Œæ£€æŸ¥å‘ç°æ˜¯luxonä¸­çš„æŠ¥é”™ï¼Œä¸æ”¯æŒ`Object.assign`æ–¹æ³•ã€‚
é»˜è®¤æƒ…å†µä¸‹ babel-loader ä¼šå¿½ç•¥æ‰€æœ‰ node_modules ä¸­çš„æ–‡ä»¶ã€‚

#### è§£å†³
åœ¨ `vue.config.js` ä¸­é…ç½® `transpileDependencies` é€‰é¡¹ï¼Œåˆ—å‡ºæ¥éœ€è¦è½¬æ¢çš„ç¬¬ä¸‰æ–¹åº“ï¼Œä¸ºè¯¥ä¾èµ–é€šè¿‡ Babel æ˜¾å¼å¼€å¯è¯­æ³•è½¬æ¢å’Œæ ¹æ®ä½¿ç”¨æƒ…å†µæ£€æµ‹ polyfillã€‚
ä¸‹é¢æ˜¯å¼€å¯ luxon çš„ç¤ºä¾‹ã€‚

#### æ³¨æ„
1. luxon çš„ package.json ä¸­é…ç½®äº†`"module": "src/luxon.js"`ï¼Œåœ¨é¡¹ç›®ç¼–è¯‘ä¸­ä½¿ç”¨çš„æ˜¯`"build": "vue-cli-service build --modern"`ï¼Œéœ€è¦åŒæ—¶é…ç½®`mainFields: ['module', 'main']`ï¼Œè®© `import` åœ¨ä¸åŒæ¨¡å¼ä¸‹å¼•ç”¨æ­£ç¡®çš„æ–‡ä»¶ï¼Œ è¿™ä¸¤ä¸ªé€‰é¡¹éœ€è¦åŒæ—¶é…ç½®ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆè¯¥æŠ¥é”™åŸå› å°šæœªç¡®è®¤ï¼‰ï¼›
2. axios ç”¨ä¸Šé¢çš„æ–¹å¼ä¸è¡Œï¼Œä¼šäº§ç”ŸæŠ¥é”™ï¼ˆè¯¥æŠ¥é”™åŸå› å°šæœªç¡®è®¤ï¼‰ã€‚

#### å®ä¾‹ä»£ç 
```javascript
transpileDependencies: [
    'luxon',
],
configureWebpack: {
    resolve: {
        mainFields: ['module', 'main'],
    },
},
```

#### å‚è€ƒ
1. [Cli Polyfill](https://cli.vuejs.org/zh/guide/browser-compatibility.html#polyfill);
2. [resolve.mainFields](https://webpack.js.org/configuration/resolve/#resolve-mainfields);

### 4. é¡¹ç›®ä¸­çš„æŸç±»å¸¸ç”¨çš„ä¸å˜çš„[{key:value}]æ•°æ®


#### åŸå› 
é¡¹ç›®ä¸­æŸäº›ä¸‹æ‹‰æ¡†ä¸­çš„å†…å®¹ï¼ŒåŸºæœ¬ä¸å˜åˆç»å¸¸ä½¿ç”¨ã€‚é¡¹ç›®ä¸­æŸäº›å€¼è¦åº”ç”¨è¿‡æ»¤å™¨è½¬åŒ–ä¸ºç›¸åº”çš„æ–‡æœ¬ã€‚

#### è§£å†³
ç›®å‰å­˜å‚¨åœ¨localstorageä¸­ï¼Œä¸‹å‘¨è°ƒç ”èƒ½å¦å­˜å‚¨åœ¨indexDBä¸­ã€‚

#### å®ä¾‹ä»£ç 
storage.js

```javascript
export default {
    getDatasetTypes() {
        return JSON.parse(sessionStorage.getItem('datasetTypes'));
    },
    setDatasetTypes(data) {
        const types = data || [];
        sessionStorage.setItem('datasetTypes', JSON.stringify(types));
    },
};
```
api.js

```javascript
// è·å–æ•°æ®é›†çš„ç±»å‹
    getDatasetTypes() {
        return Promise.resolve([
            { label: 'å›¾åƒ', value: 1 },
            { label: 'NLP', value: 2 },
            { label: 'è¯­éŸ³', value: 4 },
        ]);
    },
```
main.js

```javascript
created() {
      this.fetchInfo().then(([types, formats, privates]) => {
          storage.setDatasetTypes(types);
          storage.setDatasetFormats(formats);
          storage.setDatasetPrivates(privates);
          this.hasInitInfo = true;
      }).catch((err) => {
          this.$Message.warning(utils.getErrorMsg(err));
      });
  }
  fetchInfo() {
      const { menuType } = this.$route.params;
      return Promise.all([datasetAPI.getDatasetTypes(), datasetAPI.getDatasetFormats(), datasetAPI.getDatasetPrivates(menuType)]);
  }
```
dataset.js

```javascript
this.categorys = storage.getDatasetTypes();
```
filter.js

```javascript
typeTransform(value) {
        if (!value) {
            return '';
        }
        let label = '';
        const datasetTypes = storage.getDatasetTypes();
        datasetTypes.forEach((item) => {
            if (item.value === value) {
                ({ label } = item);
            }
        });
        return label;
    }
```

### 4. é¡¹ç›®ä¸­çš„å­ç»„ä»¶çš„propsçš„è§„èŒƒå†™æ³•

#### åŸå› 
æ— è®ºæˆ‘ä»¬çš„ç»„ä»¶propså±æ€§å†™æˆæ•°ç»„è¿˜æ˜¯å¯¹è±¡ï¼Œvueéƒ½ä¼šå¸®æˆ‘ä»¬æŠŠå±æ€§å€¼è½¬åŒ–ä¸º{type: val}çš„å½¢å¼ã€‚
```javascript
    function normalizeProps (options: Object, vm: ?Component) {
        const props = options.props
        if (!props) return
        const res = {}
        let i, val, name
        if (Array.isArray(props)) {
            i = props.length
            while (i--) {
                val = props[i]
                if (typeof val === 'string') {
                    name = camelize(val)
                    res[name] = { type: null }
                } else if (process.env.NODE_ENV !== 'production') {
                    warn('props must be strings when using array syntax.')
                }
            }
        } else if (isPlainObject(props)) {
            for (const key in props) {
                val = props[key]
                name = camelize(key)
                res[name] = isPlainObject(val)
                    ? val
                    : { type: val }
            }
        } else if (process.env.NODE_ENV !== 'production') {
            warn(
                `Invalid value for option "props": expected an Array or an Object, ` +
                `but got ${toRawType(props)}.`,
                vm
            )
        }
        options.props = res
    }
```

#### è§£å†³æ–¹æ³•
å°†æ‰€æœ‰å­ç»„ä»¶çš„propså±æ€§å†™æˆå¦‚ä¸‹å½¢å¼,å…å»vueå†…éƒ¨çš„è½¬æ¢ï¼Œå¹¶å¯ä»¥æ ¡éªŒæˆ‘ä»¬çš„ä¼ å€¼æ˜¯å¦æ­£ç¡®ã€‚
```javascript
    props: {
        [propName]: {
            type: val,
            default: val,
            ...
        }
    }
```

### 5. templateä¸­åªåŒ…å«ç®€å•çš„è¡¨è¾¾å¼
#### åŸå› 
å¤æ‚è¡¨è¾¾å¼ä¼šè®©ä½ çš„æ¨¡æ¿è¿‡é‡ä¸”éš¾ä»¥ç»´æŠ¤ã€‚æˆ‘ä»¬åº”è¯¥å°½é‡æè¿°åº”è¯¥å‡ºç°çš„æ˜¯ä»€ä¹ˆï¼Œè€Œéå¦‚ä½•è®¡ç®—é‚£ä¸ªå€¼ã€‚
```javascript
    {{
        fullName.split(' ').map(function (word) {
        return word[0].toUpperCase() + word.slice(1)
        }).join(' ')
    }}
```
#### è§£å†³æ–¹æ³•
å°½é‡å†™æˆæœ‰è¯­ä¹‰çš„è®¡ç®—å±æ€§æˆ–æ–¹æ³•ã€filterï¼Œä»è€Œä½¿å¾—ä»£ç å¯ä»¥é‡ç”¨
```javascript
    computed: {
        normalizedFullName: function () {
            return this.fullName.split(' ').map(function (word) {
                return word[0].toUpperCase() + word.slice(1)
            }).join(' ')
        }
    }
```

### 6. é¡¹ç›®æ–‡ä»¶å¤¹å±‚çº§è¿‡å¤š

#### åŸå› 
æ–‡ä»¶å¤¹çš„è®¾ç½®ä¹ æƒ¯äºå‚ç…§äº§å“èœå•æ¥åˆ›å»ºï¼Œèœå•å‡ºç°ä¸‰çº§å­èœå•æ—¶ï¼Œä¾ç…§ç°æœ‰çš„æ–‡ä»¶å¤¹å»ºç«‹æ–¹å¼ä¼šå‡ºç°7çº§åµŒå¥—ï¼Œä¸åˆ©äºç»´æŠ¤å¼€å‘ï¼›

#### è§£å†³æ–¹æ³•
è·³å‡ºåŸæœ‰çš„æ€ç»´é™åˆ¶ï¼ŒæŒ‰ç…§å…·ä½“é¡¹ç›®æ¥å»ºç«‹ä¸€çº§æ–‡ä»¶å¤¹ï¼Œé¿å…è¿‡æ·±çš„æ–‡ä»¶å¤¹å±‚çº§åµŒå¥—ï¼Œè¿™æ ·ä¹Ÿæœ‰åˆ©äºè·¯ç”±çš„é…ç½®ç®€åŒ–ï¼›

é€šè¿‡è·¯å¾„è§„åˆ’è®¾ç½®ï¼Œè®©é…ç½®æ›´ç®€ç»ƒï¼Œå±è”½è¯·æ±‚è·¯å¾„å·®å¼‚

### 5. `number`ä¿®é¥°å™¨å’Œ`rules`æ ¡éªŒè§„åˆ™è®¾ç½®ç»†èŠ‚

#### åœºæ™¯
é’ˆå¯¹è¡¨å•éªŒè¯ä¸­éœ€è¦æ ¡éªŒæ•°å­—åŒºé—´çš„åœºæ™¯ï¼Œå³å¡«å†™çš„æ•°å­—éœ€è¦åœ¨`[min, max]`åŒºé—´ã€‚

#### ç»†èŠ‚
1. è®¾ç½®`v-model`çš„ä¿®é¥°å™¨`number`ï¼Œå°†è¾“å…¥ç›´æ¥è½¬åŒ–ä¸ºæ•°å­—å­˜å‚¨åˆ°æ¨¡å‹å˜é‡ä¸­ï¼›
2. ç¡®ä¿iViewçš„è¡¨å•æ ¡éªŒè§„åˆ™[async-validator](https://github.com/yiminghe/async-validator)ä¸­çš„`type`å’Œæ¨¡å‹å˜é‡çš„ç±»å‹ä¿æŒä¸€è‡´ï¼Œå³æ˜¾ç¤ºå£°æ˜ä¸º`number`ã€`float`æˆ–`integer`ç±»å‹ï¼ˆé»˜è®¤çš„æ•°æ®ç±»å‹æ˜¯`string`ï¼‰ï¼›
3. å¦‚æœæ ¡éªŒè§„åˆ™ä¸­ä½¿ç”¨äº†`integer`ï¼Œåˆ™è¿›ä¸€æ­¥çº¦æŸ`v-model`ä¸­çš„`number`æ˜¯æ•´æ•°ï¼Œ`float`åŒç†ï¼›
4. `type`é…ç½®å’Œå¯¹åº”çš„`require`ã€`min`å’Œ`max`è”åˆä½¿ç”¨ï¼Œåˆ†åˆ«é…ç½®ã€‚

#### è§£å†³æ–¹æ³•
```html
<i-input
    // æ·»åŠ `number`ä¿®é¥°å™¨
    v-model.number="form.disk"
    placeholder="è¯·è¾“å…¥æ•°æ®ç›˜å¤§å°"
    type="number"
    name="disk"
    required
    min="20"
    max="500"
>
    <span slot="append">GB</span>
</i-input>
```

```javascript
// åˆ†åˆ«è®¾ç½®æ ¡éªŒè§„åˆ™
disk: [
    {
        required: true,
        type: 'integer',
        message: 'éœ€è¦è¾“å…¥æ•°æ®ç›˜å¤§å°',
        trigger: 'blur',
    },
    {
        type: 'integer',
        min: 20,
        message: 'æ•°æ®ç›˜å¤§å°ä¸èƒ½å°äº20',
        trigger: 'blur',
    },
    {
        type: 'integer',
        max: 500,
        message: 'æ•°æ®ç›˜å¤§å°ä¸èƒ½å¤§äº500',
        trigger: 'blur',
    },
],
```

### 7. æ¨¡æ€æ¡†åŒå‘ç»‘å®šå¤„ç†
`v-modal`ä¼šåœ¨ç»„ä»¶å†…å¯¹ä¼ å…¥å€¼è¿›è¡Œçªå˜ã€‚
é‡‡ç”¨`$emit`æ–¹å¼ï¼Œé€šè¿‡äº‹ä»¶æŠ›ç»™çˆ¶ç»„ä»¶å¤„ç†ï¼Œç®€å†™ä¸º`.sync`ã€‚
æ˜¯å¦å¯ä»¥æ›¿ä»£`v-modal`ã€‚

### è·¯ç”±ç»„ä»¶ä¼ å‚
å¸¸è§è·¯ç”±ä¼ å‚ï¼š
```javascript
const User = {
  template: '<div>User {{ $route.params.id }}</div>'
}

const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User },
  ]
})
```
ç»„ä»¶å’Œè·¯ç”±é«˜åº¦è€¦åˆï¼Œä½¿ç”¨idæ—¶å¿…é¡»ç”±é€šè¿‡è·¯ç”±è·å–ã€‚

é€šè¿‡`props`è§£è€¦ï¼š
```javascript
const User = {
  props: ['id'],
  template: '<div>User {{ id }}</div>'
}

const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User, props: true },
  ]
})
```
å…¶å®ƒç»„ä»¶ä¹Ÿå¯é€šè¿‡ä¼ å…¥idçš„æ–¹å¼ä½¿ç”¨`User`ç»„ä»¶ã€‚

### 5. `$refs`ç”Ÿæ•ˆæ—¶æœº

#### ç»“è®º
ç»è¿‡æµ‹è¯•ï¼Œ`$refs`æœ€æ—©åœ¨`mounted`ä¸­ç”Ÿæ•ˆã€‚


---
## Nginxé…ç½®

```nginx
# å¼€å‘æœºé…ç½®
location /console {
    try_files $uri $uri/ /console/index.html;
    alias /home/haoweilai/webapp/console-static/;
    index index.html;
}
location /console-assets/ {
    alias /home/haoweilai/webapp/console-static/console-assets/;
}
```

```nginx
# æµ‹è¯•æœºé…ç½®
location /console {
    try_files $uri $uri/ /console/index.html;
    alias /home/ubuntu/webapp/console-static/;
    index index.html;
}
location /console-assets/ {
    alias /home/ubuntu/webapp/console-static/console-assets/;
}
```


## æ¨¡å¼

### widgetæ¨¡å¼
widget æ¨¡å¼åå­—å€Ÿé‰´äº [Web Widget](https://zh.wikipedia.org/wiki/Web_Widget)ï¼Œä¸å…¶å«ä¹‰åŸºæœ¬ç›¸åŒï¼Œè¡¨ç¤ºå°éƒ¨ä»¶ã€å°å·¥å…·ã€æŒ‚ä»¶ç­‰ï¼ŒåŒ…å«å¯åœ¨ä»»æ„åœ°æ–¹ç›´æ¥è°ƒç”¨å¹¶æ‰§è¡Œçš„å«ä¹‰ã€‚

åœ¨ä¸€ä¸ªé¡µé¢ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªVueå®ä¾‹ï¼Œå°†ç‹¬ç«‹å°ç»„ä»¶å°è£…æˆå•ç‹¬Vueçš„å®ä¾‹ï¼Œå¹¶æä¾›å‡½æ•°çš„è°ƒç”¨æ¥å£ï¼Œå³widgetã€‚

éœ€è¦ä½¿ç”¨çš„æ—¶å€™å³ç›´æ¥è°ƒç”¨ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨DOMç§æ’å…¥æ–°çš„Vueå®ä¾‹ï¼Œé€šè¿‡å›è°ƒæˆ–Promiseçš„å½¢å¼å®Œæˆæ•°æ®çš„ä¼ é€’ã€‚

### è§£å†³çš„é—®é¢˜
åœ¨å…¸å‹çš„Vueæ¶æ„ä¸­ï¼ŒUIç»„ä»¶çš„å±•ç¤ºæ˜¯å¯¹ç»„ä»¶æ ‘ä¸­æŸä¸ªç»„ä»¶çš„çŠ¶æ€æ”¹å˜ï¼ˆv-ifã€v-showç­‰ï¼‰ï¼Œå¯¹äºè·Ÿä¸šåŠ¡ä»£ç æ‰§è¡ŒæŸä¸ªå°åˆ†å‰é€»è¾‘æœ‰å…³çš„ç‹¬ç«‹å°ç»„ä»¶ï¼ˆæ¯”å¦‚ Alertã€Confirmã€Promptã€Tip ç­‰ï¼‰æœ‰äº›åˆ»æ¿å’Œæ²‰é‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´æœ‰åˆ©äºè°ƒç”¨å‡½æ•°ç­‰å½¢å¼ä¼šæ›´ä¾¿äºä½¿ç”¨ã€‚

ç”±äºå‡å°‘ç»„ä»¶æ ‘ä¸­æ­¤ç±»ç»„ä»¶çš„å ä½ï¼Œä¹Ÿå¯ä»¥ä¼˜åŒ–ç¨‹åºçš„æ€§èƒ½ã€‚

### ç¤ºä¾‹
1. [re-authorize](/zhiyucloud-fe/src/common/widgets/re-authorize.js)ï¼›

---
## é¡¹ç›®å¯åŠ¨
```
npm install
```

### å¼€å‘å‘½ä»¤ï¼ˆæ”¯æŒHMRï¼‰
```
npm run serve
```

### ç¼–è¯‘å‘½ä»¤
```
npm run build
```

### Lintå‘½ä»¤
```
npm run lint
```

